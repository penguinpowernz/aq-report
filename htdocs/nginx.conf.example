# nginx configuration for AQ Intelligence Report Dashboard
# Copy to /etc/nginx/sites-available/aq-report

server {
    listen 80;
    server_name localhost;  # Change to your domain or IP

    # Document root - adjust path as needed
    root /home/robert/src/golang/src/github.com/penguinpowernz/aq-report/htdocs;
    index index.html;

    # Logging
    access_log /var/log/nginx/aq-report-access.log;
    error_log /var/log/nginx/aq-report-error.log;

    # Main location
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Static assets caching
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|dot)$ {
        expires 30d;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    # Security headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;

    # Gzip compression
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;
}

# HTTPS Configuration (recommended for production)
# Uncomment and configure if you have SSL certificates
#
# server {
#     listen 443 ssl http2;
#     server_name your-domain.com;
#
#     ssl_certificate /path/to/cert.pem;
#     ssl_certificate_key /path/to/key.pem;
#     ssl_protocols TLSv1.2 TLSv1.3;
#     ssl_ciphers HIGH:!aNULL:!MD5;
#
#     root /home/robert/src/golang/src/github.com/penguinpowernz/aq-report/htdocs;
#     index index.html;
#
#     # ... rest of configuration same as above ...
# }
#
# # Redirect HTTP to HTTPS
# server {
#     listen 80;
#     server_name your-domain.com;
#     return 301 https://$server_name$request_uri;
# }

# Optional: Basic Authentication
# Uncomment to require password authentication
#
# location / {
#     auth_basic "AQ Intelligence Report - Restricted";
#     auth_basic_user_file /etc/nginx/.htpasswd;
#     try_files $uri $uri/ /index.html;
# }
#
# Create password file with:
# sudo htpasswd -c /etc/nginx/.htpasswd username

# Optional: IP Restriction
# Uncomment to allow only specific IPs
#
# location / {
#     allow 192.168.1.0/24;  # Your network
#     allow 10.0.0.0/8;      # VPN range
#     deny all;
#     try_files $uri $uri/ /index.html;
# }
